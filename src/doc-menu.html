<dom-module id='doc-menu'>
  <style>
    :host {
      float: left;
    }

    .toggle {
      -webkit-appearance: none;
      -moz-appearance: none;
      border: 0;
      background-color: inherit;
      height: 2em;
      width: 2em;
      top: -0.4em;
      position: relative;
    }

    .toggle:before, .toggle:after {
      content: '';
      display: block;
      background-color: white;
      position: absolute;
      width: 2em;
      height: 0.4em;
      opacity: 1;
      left: 0;
      transition: transform 0.3s, background-color 0.2s;
      transition-timing-function: cubic-bezier(.29, .82, .34, .99);
      transform-origin: 50.1%;
      border-radius: 0.2em;
    }

    .toggle:before {
      top: 0.3em;
    }

    .toggle:after {
      bottom: 0.3em;
    }

    div:not(.shown) > .dropdown {
      opacity: 0;
      pointer-events: none;
    }

    div.shown .toggle:before {
      transform: translateY(0.5em) rotate(45deg);
    }

    div.shown .toggle:after {
      transform: translateY(-0.5em) rotate(-45deg);
    }

    .toggle:hover:before, .toggle:hover:after {
      background-color: #7596ff;
    }

    .dropdown {
      width: 100%;
      left: 0;
      margin-top: 0.6em;
      box-sizing: border-box;
      transition-property: opacity;
      transition-timing-function: cubic-bezier(.29, .82, .34, .99);
      transition-duration: 0.3s;
      position: absolute;
      background-color: rgba(250, 250, 250, 0.95);
      background-color: #7596ff;
      color: black;
      font-size: 0.8em;
      z-index: 5000;
    }
    .dropdown a {
      color:white;
    }

    ul {
      list-style: none;
      margin: 0;
      padding: 0 !important;
      text-align: center;
    }

    ul ul {
      text-align: left;
      vertical-align: top;
      display: inline-block;
      width: 50%;
      max-width: 18.75em;
      box-sizing: border-box;
      margin-top: 2em;
      margin-bottom: 2em;
    }

    @media (max-width: 34.99999999999em) {
      ul ul:nth-child(2n + 1) {
        clear: both;
      }
    }

    @media (min-width: 35em) {
      ul ul {
        width: 21%;
      }

      ul ul:nth-child(4n + 1) {
        clear: both;
      }
    }

    ul ul li a, ul[label]:before {
      display: block;
      padding: 0.3em 2em;
    }

    ul[label]:before {
      content: attr(label);
    }

    .hint.disposed {
      opacity: 0;
      pointer-events: none;
    }

    .hint {
      background-color: black;
      color: #e2e2e2;
      padding: 0.3em 0.6em;
      font-size: 0.8em;
      position: absolute;
      z-index: 1000;
      display: inline-block;
      border-radius: 0.2em;
      margin-left: 2em;
      transition:opacity 0.2s;
      animation: bob 1s infinite ease;
    }

    .hint:before {
      content: '';
      background-color: black;
      position: absolute;
      transform: rotate(45deg);
      height: 0.7em;
      width: 0.7em;
      left: -0.2em;
      top: 0.6em;
      z-index: 900;
    }

    @keyframes bob {
      0% {
        transform: translateX(0em);
      }

      50% {
        transform: translateX(0.3em);
      }

      100% {
        transform: translateX(0em);
      }
    }
  </style>
  <template>
    <div class$='{{ _shownClass(shown) }}'>
      <button class='toggle' on-click='toggle'></button>
      <span class$="{{ _hintClass(shown) }}">Use this menu to browse the documentation</span>
      <ul class='dropdown'>
        <template is='dom-repeat' items="{{ categories }}">
          <ul class="category" label$='{{ item.label }}'>
            <template is="dom-repeat" items="{{ item.items }}">
              <li>
                <a href="{{ _toHashDocHref(item.url) }}">{{ item.title }}</a>
              </li>
            </template>
          </ul>
        </template>
      </ul>
    </div>
  </template>
  <script>
    Polymer({
      properties: {
        categories: {
          type: Array,
          value: Docs.index
        },
        shown: {
          type: Boolean,
          value: false
        }
      },

      _shownClass: function (shown) {
        return shown ? 'shown' : '';
      },

      _toHashDocHref: function (url) {
        return '#/docs' + url;
      },

      toggle: function () {
        document.body.classList.add('hint-disposed');
        this.shown = !this.shown;
      },

      _hintClass: function (shown) {
        return 'hint' + (document.body.classList.contains('hint-disposed') ? ' disposed' : '');
      },
    })
  </script>
</dom-module>